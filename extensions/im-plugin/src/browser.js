const _0x5837=['defineProperty','validate','load','uninit','cannot\x20hide\x20panel,\x20panelWin\x20is\x20undefined','ipcMain','./main-lib/controller','length','error','new-version-found','onHidePanel','Panel','__importDefault','getPackages','replace','default','./common-lib/update-toolbar','join','getRedirectUrl','./node_modules','paths','_waitClosedMain',':hide-panel','init','BrowserWindow',':get-version','push','returnValue','send','cancel','path','./common-lib/translate','button_title','unload','removeListener','./common-lib/dialog','./constant/namespace','extension','methods','info','./main-lib/service','onShowPanel','getInstance','hide','plugin_version','plugin_url','__esModule','close','updateToolbar'];(function(_0x290822,_0x58c676){const _0x583703=function(_0x3d5d7f){while(--_0x3d5d7f){_0x290822['push'](_0x290822['shift']());}};_0x583703(++_0x58c676);}(_0x5837,0x67));const _0x3d5d=function(_0x290822,_0x58c676){_0x290822=_0x290822-0x1db;let _0x583703=_0x5837[_0x290822];return _0x583703;};const _0x5c3949=_0x3d5d;'use strict';var __importDefault=this&&this[_0x5c3949(0x1e2)]||function(_0x373063){const _0x3ef70e=_0x5c3949;return _0x373063&&_0x373063[_0x3ef70e(0x204)]?_0x373063:{'default':_0x373063};};Object[_0x5c3949(0x207)](exports,'__esModule',{'value':!0x0}),exports[_0x5c3949(0x1f7)]=exports[_0x5c3949(0x209)]=exports[_0x5c3949(0x1fc)]=void 0x0;const path_1=__importDefault(require(_0x5c3949(0x1f4))),compare_versions_1=__importDefault(require('compare-versions')),electron_1=require('electron'),service_1=__importDefault(require(_0x5c3949(0x1fe))),translate_1=require(_0x5c3949(0x1f5)),dialog_1=require(_0x5c3949(0x1f9)),namespace_1=require(_0x5c3949(0x1fa)),update_toolbar_1=require(_0x5c3949(0x1e6)),controller_1=__importDefault(require(_0x5c3949(0x1dc)));module[_0x5c3949(0x1ea)][_0x5c3949(0x1f0)](path_1[_0x5c3949(0x1e5)][_0x5c3949(0x1e7)](Editor['App'][_0x5c3949(0x1f4)],_0x5c3949(0x1e9)));const windows=require('@base/electron-windows'),controller=controller_1['default'][_0x5c3949(0x200)]();let panelWin=null,newVersionChecked=!0x1;function load(){const _0x260df3=_0x5c3949;electron_1[_0x260df3(0x1db)]['on'](namespace_1['ns']+':hide-panel',hidePanel),electron_1['ipcMain']['on'](namespace_1['ns']+_0x260df3(0x1ef),getVersion_),controller[_0x260df3(0x1ed)]();}function unload(){const _0x545043=_0x5c3949;electron_1['ipcMain'][_0x545043(0x1f8)](namespace_1['ns']+_0x545043(0x1ec),hidePanel),electron_1[_0x545043(0x1db)]['removeListener'](namespace_1['ns']+_0x545043(0x1ef),getVersion_),controller[_0x545043(0x20a)]();}exports[_0x5c3949(0x209)]=load,exports[_0x5c3949(0x1f7)]=unload;let savedInfo=null;const methods={'showPanel'(){const _0xe0c862=_0x5c3949;panelWin?(panelWin['show'](),panelWin=null):Editor[_0xe0c862(0x1e1)]['open'](namespace_1['ns']),controller[_0xe0c862(0x1ff)]();},'domReady'(){checkUpdate();},'closePanel'(){const _0x4aefab=_0x5c3949;Editor[_0x4aefab(0x1e1)][_0x4aefab(0x205)](namespace_1['ns']),panelWin=null,controller['onClosePanel']();},'whetherClose':()=>windows[_0x5c3949(0x1eb)],'getSignInUrl':async()=>(await service_1['default'][_0x5c3949(0x200)]())['getSignInUrl'](),'getRedirectUrl':async _0x12e41f=>(await service_1[_0x5c3949(0x1e5)][_0x5c3949(0x200)]())[_0x5c3949(0x1e8)](_0x12e41f),'updateToolbarMain'(_0x3ea1a7,_0x842ec4){const _0x11c97f=_0x5c3949;update_toolbar_1[_0x11c97f(0x206)](_0x3ea1a7,_0x842ec4);},'saveToolbarInfo'(_0x3cf8a2){savedInfo=_0x3cf8a2;},'getSavedToolbarInfo':()=>savedInfo};function hidePanel(_0x2f5e86){const _0x45c134=_0x5c3949;panelWin=electron_1[_0x45c134(0x1ee)]['fromWebContents'](_0x2f5e86['sender']),panelWin?(panelWin[_0x45c134(0x201)](),controller[_0x45c134(0x1e0)]()):console[_0x45c134(0x1de)](_0x45c134(0x20b));}function getVersion_(_0x247860){const _0x4fa4bf=_0x5c3949;_0x247860[_0x4fa4bf(0x1f1)]=getVersion();}function getVersion(){const _0x5c3367=_0x5c3949,_0x28ba21=Editor['Package'][_0x5c3367(0x1e3)]({'name':namespace_1['ns']});return _0x28ba21[_0x28ba21[_0x5c3367(0x1dd)]-0x1]['version'];}async function checkUpdate(){const _0x5abc5a=_0x5c3949;if(newVersionChecked)return;newVersionChecked=!0x0;const _0x1efa74=await service_1[_0x5abc5a(0x1e5)][_0x5abc5a(0x200)](),_0x39e75a=await _0x1efa74['getImSetting']();if(!_0x39e75a||!_0x39e75a[_0x5abc5a(0x202)]||!_0x39e75a[_0x5abc5a(0x203)])return;const _0x2e7d2d=_0x39e75a[_0x5abc5a(0x202)];if(!compare_versions_1['default'][_0x5abc5a(0x208)](_0x2e7d2d))return;const _0xfc2877=getVersion();if(compare_versions_1[_0x5abc5a(0x1e5)](_0x2e7d2d,_0xfc2877)<=0x0)return;const _0x31cb03=translate_1['tr'](_0x5abc5a(0x1df))[_0x5abc5a(0x1e4)]('_1',_0x39e75a[_0x5abc5a(0x1f6)])[_0x5abc5a(0x1e4)]('_2',_0x2e7d2d);0x1!==await dialog_1[_0x5abc5a(0x1fd)](_0x31cb03,{'title':translate_1['tr']('info-title'),'buttons':[translate_1['tr']('ok'),translate_1['tr'](_0x5abc5a(0x1f3))],'default':0x0,'cancel':0x1})&&Editor['Message'][_0x5abc5a(0x1f2)](_0x5abc5a(0x1fb),'update-extension',_0x39e75a['plugin_url'],namespace_1['ns'],'global');}exports[_0x5c3949(0x1fc)]=methods;