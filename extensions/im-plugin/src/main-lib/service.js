const _0x3240=['imSetting','defineProperty','getUserData','&redirect_url=','getRedirectUrl','I18n','entry_url','getButtonTitle','getSessionToken','postData','sessionId','/account/client_signin?session_id=','User','init','data','default','error','getNewMsgCount','requestService','instance','session_id','get\x20session\x20failed','__esModule','getImSetting\x20failed','isVip','getSessionCode','./http-utils','getData','indexOf','button_title','sessionChanged','encodeParams','lang=','getSignInUrl','/session/token','https://creator-api.cocos.com/api','session_token','cleanImSetting','/service/get_im_setting','remote','msg_api_url','/session/code','getImSetting','session_code','init\x20failed,\x20cannot\x20get\x20session\x20id','sessionCode','sessionToken'];(function(_0x550263,_0x17fcb1){const _0x324018=function(_0x3909f2){while(--_0x3909f2){_0x550263['push'](_0x550263['shift']());}};_0x324018(++_0x17fcb1);}(_0x3240,0x11e));const _0x3909=function(_0x550263,_0x17fcb1){_0x550263=_0x550263-0x12a;let _0x324018=_0x3240[_0x550263];return _0x324018;};const _0x2b1bc7=_0x3909;'use strict';Object[_0x2b1bc7(0x156)](exports,_0x2b1bc7(0x13c),{'value':!0x0});const http_utils_1=require(_0x2b1bc7(0x140)),apiBaseUrl=_0x2b1bc7(0x149);class Service{constructor(){const _0x10e6c0=_0x2b1bc7;this[_0x10e6c0(0x130)]=null,this[_0x10e6c0(0x153)]=null,this[_0x10e6c0(0x154)]=null,this[_0x10e6c0(0x155)]=null;}static async['getInstance'](){const _0x17a5da=_0x2b1bc7;if(Service[_0x17a5da(0x139)]&&!await Service[_0x17a5da(0x139)][_0x17a5da(0x144)]())return Service[_0x17a5da(0x139)];const _0x3aa429=new Service();return await _0x3aa429[_0x17a5da(0x133)](),Service[_0x17a5da(0x139)]=_0x3aa429,_0x3aa429;}async[_0x2b1bc7(0x144)](){const _0x3744aa=_0x2b1bc7;return(await this[_0x3744aa(0x157)]())[_0x3744aa(0x13a)]!==this[_0x3744aa(0x130)];}async['getUserData'](){const _0x449b37=_0x2b1bc7;let _0x1a7b2c=null;return _0x1a7b2c=Editor['User'][_0x449b37(0x141)](),_0x1a7b2c['then']||(_0x1a7b2c=Editor[_0x449b37(0x14d)][_0x449b37(0x132)][_0x449b37(0x141)]()),_0x1a7b2c;}async[_0x2b1bc7(0x133)](){const _0x2fe438=_0x2b1bc7,_0x5a9254=await this[_0x2fe438(0x157)]();if(this[_0x2fe438(0x130)]=_0x5a9254[_0x2fe438(0x13a)],this[_0x2fe438(0x130)])try{this[_0x2fe438(0x153)]=await this[_0x2fe438(0x13f)](this['sessionId']),this['sessionToken']=await this[_0x2fe438(0x12e)](this[_0x2fe438(0x153)]);}catch(_0x4af240){console[_0x2fe438(0x136)](_0x2fe438(0x13b)),console[_0x2fe438(0x136)](_0x4af240);}else console[_0x2fe438(0x136)](_0x2fe438(0x152));}async[_0x2b1bc7(0x150)](){const _0x349799=_0x2b1bc7;if(this['imSetting'])return this[_0x349799(0x155)];try{const _0xdd9dc6=await this['requestService'](apiBaseUrl+_0x349799(0x14c),{'session_token':this['sessionToken']});return this[_0x349799(0x155)]=_0xdd9dc6['data'],_0xdd9dc6['data'];}catch(_0x58a69c){return console['error'](_0x349799(0x13d)),null;}}[_0x2b1bc7(0x14b)](){const _0x2f01cb=_0x2b1bc7;this[_0x2f01cb(0x155)]=null;}async[_0x2b1bc7(0x12d)](){const _0x468d08=_0x2b1bc7,_0x490950=await this['getImSetting']();return _0x490950?_0x490950[_0x468d08(0x143)]:'';}async[_0x2b1bc7(0x13e)](){const _0x4604d9=_0x2b1bc7,_0x48339a=await this[_0x4604d9(0x150)]();return!!_0x48339a&&!!_0x48339a['user_licnese'];}async[_0x2b1bc7(0x137)](){const _0x182170=_0x2b1bc7,_0x244d60=await this[_0x182170(0x150)]();if(!_0x244d60)return 0x0;try{const _0x19d0e2=await http_utils_1[_0x182170(0x12f)](_0x244d60[_0x182170(0x14e)]);return _0x19d0e2[_0x182170(0x134)]?_0x19d0e2[_0x182170(0x134)]:0x0;}catch(_0x7e03d2){return 0x0;}}async['shouldShowEntrance'](){const _0x5b7ac1=await this['getImSetting']();return!!_0x5b7ac1&&!!_0x5b7ac1['show_entrance'];}async[_0x2b1bc7(0x147)](){const _0x39d735=_0x2b1bc7,_0x3b3c16=await this[_0x39d735(0x150)]();return _0x3b3c16?this[_0x39d735(0x12a)](_0x3b3c16[_0x39d735(0x12c)]):null;}[_0x2b1bc7(0x12a)](_0x4de9b9){const _0x23b9a8=_0x2b1bc7,_0x3ebdd7=_0x4de9b9+(_0x4de9b9[_0x23b9a8(0x142)]('?')>=0x0?'&':'?')+(_0x23b9a8(0x146)+Editor[_0x23b9a8(0x12b)]['getLanguage']());return apiBaseUrl+_0x23b9a8(0x131)+this['sessionId']+_0x23b9a8(0x158)+encodeURIComponent(_0x3ebdd7);}async[_0x2b1bc7(0x13f)](_0x263bd9){const _0x4756cd=_0x2b1bc7;return(await this[_0x4756cd(0x138)](apiBaseUrl+_0x4756cd(0x14f),{'session_id':_0x263bd9}))[_0x4756cd(0x134)][_0x4756cd(0x151)];}async[_0x2b1bc7(0x12e)](_0x2cedb1){const _0x280ff5=_0x2b1bc7;return(await this['requestService'](apiBaseUrl+_0x280ff5(0x148),{'session_code':_0x2cedb1}))['data'][_0x280ff5(0x14a)];}async[_0x2b1bc7(0x138)](_0x1770b0,_0x2b1d2c){const _0x57478e=_0x2b1bc7;return http_utils_1['postData'](_0x1770b0,http_utils_1[_0x57478e(0x145)](_0x2b1d2c));}}exports[_0x2b1bc7(0x135)]=Service,Service[_0x2b1bc7(0x139)]=null;