const _0x1c9b=['blur','hide','i18n:change','restore','path','addBroadcastListener','focus','send','instance','info','onNotLoggedInState','onHidePanel','removeListener','name','logout','broadcast','getPackages','getInstance','login','electron','apply','Menu','setPanelBlurred','ipcMain','assign','onUserLogin','bind','Package','Message','default','cleanUp','__esModule','updateToolbar','init','__importDefault',':force-close-panel','menu','show','shouldShowEntrance','message','dispatchLoggedInState','sender','join','onPanelReady','./service','BrowserWindow','panel\x20window\x20is\x20undefined','minimize','onLanguageChanged','error','add','../constant/namespace','onLoggedInShouldShowState','onShowPanel','onUserLogout','removeBroadcastListener','isVip','User','setMenuVisibility',':panel-ready','remove','onLoggedInShouldNotShowState'];(function(_0x11deeb,_0x1f1af2){const _0x1c9b35=function(_0x1bb023){while(--_0x1bb023){_0x11deeb['push'](_0x11deeb['shift']());}};_0x1c9b35(++_0x1f1af2);}(_0x1c9b,0x1a5));const _0x1bb0=function(_0x11deeb,_0x1f1af2){_0x11deeb=_0x11deeb-0x79;let _0x1c9b35=_0x1c9b[_0x11deeb];return _0x1c9b35;};const _0x170e2f=_0x1bb0;'use strict';var __importDefault=this&&this[_0x170e2f(0xa8)]||function(_0x4ab338){return _0x4ab338&&_0x4ab338['__esModule']?_0x4ab338:{'default':_0x4ab338};};Object['defineProperty'](exports,_0x170e2f(0xa5),{'value':!0x0});const path_1=__importDefault(require(_0x170e2f(0x8a))),electron_1=require(_0x170e2f(0x99)),update_toolbar_1=require('../common-lib/update-toolbar'),namespace_1=require(_0x170e2f(0x7b)),new_msg_count_timer_1=__importDefault(require('./new-msg-count-timer')),service_1=__importDefault(require(_0x170e2f(0xb2))),newMsgCountTimer=new_msg_count_timer_1[_0x170e2f(0xa3)][_0x170e2f(0x97)]();class Controller{constructor(){const _0x2ed98d=_0x170e2f;this[_0x2ed98d(0x9f)]=this[_0x2ed98d(0x9f)][_0x2ed98d(0xa0)](this),this[_0x2ed98d(0x7e)]=this[_0x2ed98d(0x7e)][_0x2ed98d(0xa0)](this),this['onLanguageChanged']=this[_0x2ed98d(0xb6)][_0x2ed98d(0xa0)](this),this[_0x2ed98d(0xb1)]=this[_0x2ed98d(0xb1)]['bind'](this);}static[_0x170e2f(0x97)](){const _0x546773=_0x170e2f;return this[_0x546773(0x8e)]||(this['instance']=new Controller()),this['instance'];}async[_0x170e2f(0xa7)](){const _0x3a7e8c=_0x170e2f;Editor[_0x3a7e8c(0x81)]['on'](_0x3a7e8c(0x98),this['onUserLogin']),Editor[_0x3a7e8c(0x81)]['on'](_0x3a7e8c(0x94),this[_0x3a7e8c(0x7e)]),Editor[_0x3a7e8c(0xa2)][_0x3a7e8c(0x8b)]('i18n:change',this[_0x3a7e8c(0xb6)]),electron_1['ipcMain']['on'](namespace_1['ns']+_0x3a7e8c(0x83),this['onPanelReady']),await Editor[_0x3a7e8c(0x81)]['isLoggedIn']()?this[_0x3a7e8c(0xae)]():(this[_0x3a7e8c(0x90)](),setTimeout(()=>{const _0x304fab=_0x3a7e8c;this[_0x304fab(0x82)](!0x1);},0x1f4));}['uninit'](){const _0x31d991=_0x170e2f;Editor[_0x31d991(0x81)]['removeListener'](_0x31d991(0x98),this[_0x31d991(0x9f)]),Editor[_0x31d991(0x81)][_0x31d991(0x92)](_0x31d991(0x94),this[_0x31d991(0x7e)]),Editor[_0x31d991(0xa2)][_0x31d991(0x7f)](_0x31d991(0x88),this[_0x31d991(0xb6)]),electron_1[_0x31d991(0x9d)][_0x31d991(0x92)](namespace_1['ns']+_0x31d991(0x83),this[_0x31d991(0xb1)]);}[_0x170e2f(0x7d)](){const _0x4660f6=_0x170e2f;newMsgCountTimer[_0x4660f6(0xa4)](),update_toolbar_1['updateToolbar']({'newMsgCount':0x0},!0x0),update_toolbar_1['setPanelBlurred'](!0x1);}[_0x170e2f(0x91)](){const _0x42151e=_0x170e2f;update_toolbar_1[_0x42151e(0x9c)](!0x0);}['onClosePanel'](){const _0xfa7104=_0x170e2f;update_toolbar_1[_0xfa7104(0x9c)](!0x0);}[_0x170e2f(0x9f)](){this['dispatchLoggedInState']();}[_0x170e2f(0x7e)](){const _0x54f134=_0x170e2f;this[_0x54f134(0x90)]();}async[_0x170e2f(0xb6)](){const _0x3f2854=_0x170e2f;await Editor[_0x3f2854(0x81)]['isLoggedIn']()&&this[_0x3f2854(0xae)]();}async['dispatchLoggedInState'](){const _0x1f6533=_0x170e2f,_0xa30b41=await service_1[_0x1f6533(0xa3)][_0x1f6533(0x97)]();_0xa30b41['cleanImSetting'](),await _0xa30b41[_0x1f6533(0xac)]()?this['onLoggedInShouldShowState']():this[_0x1f6533(0x85)]();}[_0x170e2f(0x90)](){const _0x248041=_0x170e2f;Editor['Message'][_0x248041(0x95)](namespace_1['ns']+_0x248041(0xa9)),this[_0x248041(0x82)](!0x1),update_toolbar_1[_0x248041(0xa6)]({'showToolbar':!0x1}),newMsgCountTimer[_0x248041(0xa4)]();}async[_0x170e2f(0x7c)](){const _0x548fa2=_0x170e2f,_0xf88c11=await service_1[_0x548fa2(0xa3)][_0x548fa2(0x97)](),_0x14e10b=await _0xf88c11[_0x548fa2(0x80)](),_0x3deecb=await _0xf88c11['getButtonTitle']();this[_0x548fa2(0x82)](!0x0),update_toolbar_1[_0x548fa2(0xa6)]({'showToolbar':!0x0,'isVip':_0x14e10b,'buttonTitle':_0x3deecb}),newMsgCountTimer['setUp']();}[_0x170e2f(0x85)](){this['onNotLoggedInState']();}[_0x170e2f(0xb1)](_0x4fec7c){const _0x4ceff1=_0x170e2f,_0x1bd41d=electron_1[_0x4ceff1(0xb3)]['fromWebContents'](_0x4fec7c[_0x4ceff1(0xaf)]);function _0x5f3f6b(_0x159d7b){const _0x5109a3=_0x4ceff1;_0x4fec7c['sender'][_0x5109a3(0x8d)](namespace_1['ns']+':panel-win-state-changed',_0x159d7b);}_0x1bd41d?(_0x1bd41d['on'](_0x4ceff1(0x86),_0x5f3f6b[_0x4ceff1(0xa0)](null,'blur')),_0x1bd41d['on']('focus',_0x5f3f6b[_0x4ceff1(0xa0)](null,_0x4ceff1(0x8c))),_0x1bd41d['on'](_0x4ceff1(0xab),_0x5f3f6b['bind'](null,_0x4ceff1(0xab))),_0x1bd41d['on']('hide',_0x5f3f6b[_0x4ceff1(0xa0)](null,_0x4ceff1(0x87))),_0x1bd41d['on'](_0x4ceff1(0xb5),_0x5f3f6b['bind'](null,_0x4ceff1(0xb5))),_0x1bd41d['on'](_0x4ceff1(0x89),_0x5f3f6b['bind'](null,_0x4ceff1(0x89))),_0x1bd41d['on']('blur',()=>{const _0x1c4782=_0x4ceff1;update_toolbar_1[_0x1c4782(0x9c)](!0x0);}),_0x1bd41d['on'](_0x4ceff1(0x8c),()=>{const _0x395ad5=_0x4ceff1;update_toolbar_1[_0x395ad5(0xa6)]({'newMsgCount':0x0},!0x0),update_toolbar_1['setPanelBlurred'](!0x1);})):console[_0x4ceff1(0x79)](_0x4ceff1(0xb4));}[_0x170e2f(0x82)](_0xcb3e2){const _0x269d60=_0x170e2f;var _0x3f106b;const _0x152e72=Editor[_0x269d60(0xa1)][_0x269d60(0x96)]({'name':namespace_1['ns']}),_0x599583=_0x152e72[_0x152e72['length']-0x1],_0x94b791=_0x599583[_0x269d60(0x93)],_0xbe0f06=null===(_0x3f106b=_0x599583[_0x269d60(0x8f)]['contributions'])||void 0x0===_0x3f106b?void 0x0:_0x3f106b[_0x269d60(0xaa)][0x0];_0xbe0f06&&(_0xcb3e2?Editor[_0x269d60(0x9b)][_0x269d60(0x7a)](_0xbe0f06[_0x269d60(0x8a)],Object[_0x269d60(0x9e)](Object[_0x269d60(0x9e)]({},_0xbe0f06),{'icon':path_1[_0x269d60(0xa3)][_0x269d60(0xb0)](__dirname,'../../resources/images/icon.png'),'click':()=>{const _0x4bf1c0=_0x269d60;Editor['Message'][_0x4bf1c0(0x8d)](_0x94b791,_0xbe0f06[_0x4bf1c0(0xad)]);}})):Editor[_0x269d60(0x9b)][_0x269d60(0x84)](_0xbe0f06[_0x269d60(0x8a)],_0xbe0f06),Editor['Menu'][_0x269d60(0x9a)]());}}exports[_0x170e2f(0xa3)]=Controller,Controller[_0x170e2f(0x8e)]=null;